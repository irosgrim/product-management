version: '3'

services:

    reverse-proxy:
        image: nginx:1.17.10
        container_name: reverse-proxy
        depends_on:
            - product-management-client
        volumes:
            - ./services/reverse-proxy/nginx.conf:/etc/nginx/nginx.conf
        ports:
            - 80:80

    product-management-client:
        image: product-management-client
        container_name: product-management-client
        build:
            context: ./services/client
        volumes:
            - ./services/client/dist:/usr/src/app/www
        ports:
            - 3300:3300
        restart: on-failure

    product-management-server:
        image: product-management-server
        container_name: product-management-server
        build:
            context: ./services/server
        ports:
            - 3000:3000
        env_file:
            - ./services/server/.env
        restart: on-failure
